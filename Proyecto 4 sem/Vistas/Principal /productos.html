<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verdes-Souvenir</title>
  <link rel="stylesheet" href="../../css/Estilos.css"> <!-- Enlace al CSS -->
</head>
<body>
 <header>
  <nav class="navbar">
    <img src="../../img/logo 2.png" alt="Logo empresa" class="logo">

    <ul class="menu">
      <li><a href="../home.html">Home</a></li>
      <li><a href="productos.html">Productos</a></li>
      <li><a href="blogs.html">Blog</a></li>
      <li><a href="nosotros.html">Nosotros</a></li>
      <li><a href="contacto.html">Contacto</a></li>
    </ul>

    <div class="menu">
  <a href="inicioSesion.html" class="inicio-sesion">Iniciar Sesión</a>
  <a href="registro.html" class="registro-usuario" style="margin-left:10px;">Registrarse</a>
      <a href="carrito.html" class="carrito">🛒 Carrito</a>
    </div>
  </nav>
</header>

<main>
  <section class="productos-destacados">
    <h1>Todos los productos</h1>
    <div class="lista-productos">
      <!-- Los productos se renderizan dinámicamente con JS -->
    </div>
  </section>
</main>

<script src="../../js/funcionesProductos.js"></script>
<script src="../../js/funcionesCarrito.js"></script>
<script>
  // Renderizar productos desde localStorage
  function renderizarProductosAdmin() {
    const contenedor = document.querySelector('.lista-productos');
    if (!contenedor) return;
    const productos = obtenerProductos();
    if (!productos.length) {
      contenedor.innerHTML = '<div style="text-align:center; color:#888;">No hay productos disponibles.</div>';
      return;
    }
    contenedor.innerHTML = productos.map((prod, idx) => `
      <div class="producto" data-id="${idx}">
        ${prod.imagen ? `<img src='../../img/Productos/${prod.imagen}' alt='${prod.nombre}'>` : ''}
        <h2>${prod.nombre}</h2>
        <p>$${parseFloat(prod.precio).toLocaleString('es-CL')}</p>
        <div class="agregar-carrito-cantidad" style="margin:10px 0; display:flex; align-items:center; justify-content:center; gap:8px;">
          <input type="number" min="1" value="1" class="input-cantidad" style="width:60px;">
          <button class="btn-agregar-carrito">Agregar al carrito</button>
        </div>
      </div>
    `).join('');
    // Lógica para agregar al carrito
    contenedor.querySelectorAll('.producto').forEach(productoDiv => {
      const btn = productoDiv.querySelector('.btn-agregar-carrito');
      const input = productoDiv.querySelector('.input-cantidad');
      btn.addEventListener('click', e => {
        const id = parseInt(productoDiv.dataset.id);
        const cantidad = parseInt(input.value) || 1;
        const productos = obtenerProductos();
        const producto = productos[id];
        if (!producto) return;
        // Usar la lógica de funcionesCarrito.js
        let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
        const existe = carrito.find(item => item.codigo === producto.codigo);
        if (existe) {
          existe.cantidad += cantidad;
        } else {
          carrito.push({ ...producto, cantidad });
        }
        localStorage.setItem('carrito', JSON.stringify(carrito));
        alert('Producto agregado al carrito');
      });
    });
  }
  document.addEventListener('DOMContentLoaded', renderizarProductosAdmin);
</script>
</body>
</html>